# üéØ City Clock Plugin - –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö

## üìä –†–µ–∑—é–º–µ

–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ City Clock –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

---

## ‚ùå –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ #1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–ü—Ä–∏–≤–µ—Ç**: `asyncwebserver.cpp`
- –ë—ã–ª —Ç–æ–ª—å–∫–æ API endpoint `/api/cityclock` –¥–ª—è –ü–û–õ–£–ß–ï–ù–ò–Ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–ù–ï –±—ã–ª–æ** HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –£–°–¢–ê–ù–û–í–ö–ò –≥–æ—Ä–æ–¥–∞ –∏ timezone
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞–≥–∏–Ω —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ü—Ä–æ–±–ª–µ–º–∞ #2: –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏ WebSocket –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
**–§–∞–π–ª**: `websocket.cpp`
- –õ–∏—à–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–µ —Å–∫–æ–±–∫–∏
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –≤—ã–∑–æ–≤—ã `sendInfo()`
- –ú–æ–≥–ª–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞ #3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞
**–§–∞–π–ª**: `CityClockPlugin.cpp` ‚Üí `websocketHook()`
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ—Ä–æ–¥–∞ —ç–∫—Ä–∞–Ω –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ü–∏–∫–ª–∞ loop()
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–µ–ª –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å–≤–æ–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞ #4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ —Ç–æ–º –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–ª–∞–≥–∏–Ω
- –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–∞—Ö
- –ù–µ—Ç –ø—Ä–∏–º–µ—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1Ô∏è‚É£ –î–æ–±–∞–≤–ª–µ–Ω –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `/cityclock`
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
**–§–∞–π–ª**: `src/asyncwebserver.cpp`

**–§—É–Ω–∫—Ü–∏–∏:**
- –ö—Ä–∞—Å–∏–≤—ã–π, —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Å—Ç–∏–ª–µ `/marquee`
- –í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏
- –í–≤–æ–¥ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ POSIX —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–æ —Å–Ω–æ–ø–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
- WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü–æ–ø–∞–ø—ã —Å—Ç–∞—Ç—É—Å–∞ (Connected, Not connected, Plugin not found –∏ —Ç.–¥.)

**–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üïê City Clock                  ‚îÇ
‚îÇ  Display time and weather...    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  City Name                      ‚îÇ
‚îÇ  [  London                    ] ‚îÇ
‚îÇ  Enter city name (e.g., London) ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ  Timezone (POSIX)               ‚îÇ
‚îÇ  [  GMT0                      ] ‚îÇ
‚îÇ  POSIX timezone string...       ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ  [üìç Set City]                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2Ô∏è‚É£ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ WebSocket
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
**–§–∞–π–ª**: `src/websocket.cpp` (—Å—Ç—Ä–æ–∫–∏ 85-145)

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –£–±—Ä–∞–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è—Å—è –∑–∞–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞
- –£–¥–∞–ª–µ–Ω –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è `sendInfo()`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è activePlugin –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π flow –¥–ª—è marquee –∏ cityclock —Å–æ–±—ã—Ç–∏–π

**–¢–µ–ø–µ—Ä—å:**
‚úÖ –°–æ–±—ã—Ç–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
‚úÖ sendInfo() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
‚úÖ –ù–µ—Ç null pointer –¥ereference –æ—à–∏–±–æ–∫

### 3Ô∏è‚É£ –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è websocketHook() –≤ –ø–ª–∞–≥–∏–Ω–µ
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
**–§–∞–π–ª**: `src/plugins/CityClockPlugin.cpp` (—Å—Ç—Ä–æ–∫–∏ 355-408)

**–£–ª—É—á—à–µ–Ω–∏—è:**
```cpp
// –î–û:
displayMode = 0;
modeStartTime = millis();  // –ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤–∞—Ä–∞—á–∏–≤–∞–µ–º, –∂–¥–µ–º loop()

// –ü–û–°–õ–ï:
displayMode = 0;
modeStartTime = millis();
secondTimer.forceReady();   // ‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
// –ú–µ—Ç–æ–¥ renderFrame() —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º loop()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –≠–∫—Ä–∞–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–æ–≤—ã–π –≥–æ—Ä–æ–¥ –Ω–∞ –º–∞—Ç—Ä–∏—Ü–µ —Å—Ä–∞–∑—É –∂–µ
- –ö—ç—à –ø–æ–≥–æ–¥—ã —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

### 4Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
**–§–∞–π–ª—ã**:
- `CITYCLOCK_GUIDE.md` - –ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –≤–µ—Ä—Å—ñ—è (–ø–æ–¥—Ä–æ–±–Ω–∞)
- `CITYCLOCK_GUIDE_RU.md` - –†–æ—Å—ñ–π—Å—å–∫–∞ –≤–µ—Ä—Å—ñ—è (–ø–æ–≤–Ω–∞ –∑ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏)
- `CITYCLOCK_FIXES.md` - –¢–µ—Ö–Ω—ñ—á–Ω–∏–π –∑–≤—ñ—Ç –ø—Ä–æ –≤—Å—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

**–©–æ –≤–∫–ª—é—á–µ–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é:**

1. **CITYCLOCK_GUIDE.md** (–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞):
   - Overview –ø–ª–∞–≥–∏–Ω–∞
   - Step-by-step —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è
   - –¢–∞–±–ª–∏—Ü—è —á–∞—Å–æ–≤–∏—Ö –ø–æ—è—Å—ñ–≤ –¥–ª—è —Å–≤—ñ—Ç–æ–≤–∏—Ö –º—ñ—Å—Ç
   - –ü–æ—è—Å–Ω–µ–Ω–Ω—è —Ä–µ–∂–∏–º—ñ–≤ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
   - –†—ñ—à–µ–Ω–Ω—è —Ç–∏–ø–æ–≤–∏—Ö –ø—Ä–æ–±–ª–µ–º
   - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

2. **CITYCLOCK_GUIDE_RU.md** (–†–æ—Å—ñ–π—Å—å–∫–∞):
   - –ü–æ–≤–Ω–∏–π –æ–ø–∏—Å –Ω–∞ —Ä–æ—Å—ñ–π—Å—å–∫–æ–º—É
   - –¢–∞–±–ª–∏—Ü—ñ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö –º—ñ—Å—Ç —Ç–∞ —á–∞—Å–æ–≤–∏—Ö –ø–æ—è—Å—ñ–≤
   - 50+ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π
   - –†—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –Ω–∞ —Ä–æ—Å—ñ–π—Å—å–∫–æ–º—É
   - –¢–∞–±–ª–∏—Ü—ñ –¥–ª—è –Ñ–≤—Ä–æ–ø–∏, –ê–∑—ñ—ó, –ê–º–µ—Ä–∏–∫–∏, –ê—Ñ—Ä–∏–∫–∏

3. **CITYCLOCK_FIXES.md** (–¢–µ—Ö–Ω—ñ—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è):
   - –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –∑–Ω–∞–π–¥–µ–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º
   - –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –∫–æ–∂–Ω–æ–≥–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
   - –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
   - –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

---

## üé® –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≥–æ—Ä–æ–¥–∞ –∏ —á–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞

### –ü—Ä–∏–º–µ—Ä—ã –≥–æ—Ç–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π:

| –ì–æ—Ä–æ–¥ | Timezone |
|-------|----------|
| London | `GMT0` |
| Moscow | `MSK-3` |
| Tokyo | `JST-9` |
| New York | `EST5EDT,M3.2.0,M11.1.0` |
| Berlin | `CET-1CEST,M3.5.0,M10.5.0/3` |
| Sydney | `AEST-10AEDT,M10.1.0,M4.1.0/3` |

### –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
- ‚úÖ 20+ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- ‚úÖ 30+ –ø—Ä–∏–º–µ—Ä–æ–≤ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã –¥–ª—è 8+ —Ä–µ–≥–∏–æ–Ω–æ–≤ –º–∏—Ä–∞

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
```
http://{IP_–£–°–¢–†–û–ô–°–¢–í–ê}/cityclock
```

### 2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
- **City**: London
- **Timezone**: GMT0

### 3. –ù–∞–∂–º–∏—Ç–µ "üìç Set City"

### 4. –ì–æ—Ç–æ–≤–æ!
–ù–∞ –º–∞—Ç—Ä–∏—Ü–µ –ø–æ—è–≤–∏—Ç—Å—è:
- –í—Ä–µ–º—è (HH:MM —Å –º–∏–≥–∞—é—â–∏–º –¥–≤–æ–µ—Ç–æ—á–∏–µ–º)
- –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (–ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ—Ç—Å—è)
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –∏–∫–æ–Ω–∫–∞ –ø–æ–≥–æ–¥—ã

---

## üìã –¢–µ—Å—Ç–æ–≤—ã–π —á–µ–∫-–ª–∏—Å—Ç

**–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å:**
- [ ] –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ WiFi
- [ ] NTP —Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–≤ `/config`)
- [ ] –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
- [ ] –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –≤ —Ñ–æ—Ä–º–∞—Ç–µ POSIX

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
‚úÖ –ü–æ–≥–æ–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç (—ç–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞)
‚úÖ WebSocket –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç activePlugin –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
‚úÖ Timer –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—á—ë—Ç—á–∏–∫ –∏—Ç–µ—Ä–∞—Ü–∏–π –≤–º–µ—Å—Ç–æ millis() (–∏–∑–±–µ–≥–∞–µ–º overflow)
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ NVS (–Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ)

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
‚úÖ –°—Ç—Ä–æ–∫–∏ truncated –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤ –±—É—Ñ–µ—Ä—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç overflow)
‚úÖ JSON –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
‚úÖ Null-check –¥–ª—è activePlugin –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–æ–≤

---

## üì¶ –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã

1. **src/asyncwebserver.cpp**
   - –î–æ–±–∞–≤–ª–µ–Ω –º–∞—Ä—à—Ä—É—Ç `/cityclock` —Å HTML –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

2. **src/websocket.cpp**
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è activePlugin

3. **src/plugins/CityClockPlugin.cpp**
   - –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è websocketHook()
   - –î–æ–±–∞–≤–ª–µ–Ω–æ forceReady() –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (–Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã):
   - CITYCLOCK_GUIDE.md
   - CITYCLOCK_GUIDE_RU.md
   - CITYCLOCK_FIXES.md

---

## ‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
‚ùå –ù–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚ùå WebSocket –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–º–µ–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
‚ùå –≠–∫—Ä–∞–Ω –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ—Ä–æ–¥–∞
‚ùå –ù–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
‚úÖ –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ `/cityclock`
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ WebSocket
‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –∏ —Ä—É—Å—Å–∫–æ–º
‚úÖ 50+ –≥–æ—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–ª–∞–≥–∏–Ω City Clock –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
1. –û—Ç–∫—Ä—ã—Ç—å `/cityclock`
2. –í—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –≤–≤–µ–¥–∏—Ç—å —Å–≤–æ–π
3. –í—ã–±—Ä–∞—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å
4. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É
5. –£–≤–∏–¥–µ—Ç—å –≤—Ä–µ–º—è –∏ –ø–æ–≥–æ–¥—É –Ω–∞ LED –º–∞—Ç—Ä–∏—Ü–µ

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

